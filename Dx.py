from __future__ import division
import numpy as np

def Dx(u, ny, nx, h, order):
    ux = np.zeros(np.shape(u))

    if order==2:
        # calculate partial derivatives on the boundaries:[0, m] with one-sided difference operators
        uy[0, :] = (u[:,1] -  u[:,0])/dy
        uy[nx-1, :] = (u[:,nx-1] -  u[:,nx-2])/h
        
        #calculate partial derivatives in the interior:(1:ny-1)
        for i in range(1, m):
            uy[i, :] = (u[:,i+1] -  u[:,i-1])/(2.0*h)

    elif order == 4:
        ux[:,0] = -24/17*u[:,0] + 59/34*u[:,1]  - 4/17*u[:,2] - 3/34*u[:,3]
        ux[:,1] = -1/2*u[:,0] + 1/2*u[:,2] 
        ux[:,2] = 4/43*u[:,0] - 59/86*u[:,1]  + 59/86*u[:,3] - 4/43*u[:,4]
        ux[:,3] = 3/98*u[:,0] - 59/98*u[:,2]  + 32/49*u[:,4] - 4/49*u[:,5]
        ux[:,nx-1] = 24/17*u[:,nx-1] - 59/34*u[:,nx-2]  + 4/17*u[:,nx-3] + 3/34*u[:,nx-4]
        ux[:,nx-2] = 1/2*u[:,nx-1] - 1/2*u[:,nx-3] 
        ux[:,nx-3] = -4/43*u[:,nx-1] + 59/86*u[:,nx-2]- 59/86*u[:,nx-4]+ 4/43*u[:,nx-5]
        ux[:,nx-4] = -3/98*u[:,nx-1] + 59/98*u[:,nx-3]- 32/49*u[:,nx-5]+ 4/49*u[:,nx-6]
        
        for i in xrange(4, nx-4):
            ux[:,i] = 1/12*u[:,i-2] - 2/3*u[:,i-1]  + 2/3*u[:,i+1] - 1/12*u[:,i+2]

        ux = ux/h


    elif order==6:
        ux[:,0] = -1.582533518939116*u[:,0] + 2.033378678700676*u[:,1] - 0.141512858744873*u[:,2] -0.450398306578272*u[:,3]\
                + 0.104488069284042*u[:,4] + 0.036577936277544*u[:,5]
            
        ux[:,1] = -0.462059195631158*u[:,0] + 0.287258622978251*u[:,2] + 0.258816087376832*u[:,3] - 0.069112065532624*u[:,4]\
            -0.014903449191300*u[:,5]
        
        ux[:,2] = 0.071247104721830*u[:,0] - 0.636451095137907*u[:,1] + 0.606235523609147*u[:,3] - 0.022902190275815*u[:,4]\
                 - 0.018129342917256*u[:,5]
        
        ux[:,3] = 0.114713313798970*u[:,0] - 0.290087484386815*u[:,1] - 0.306681191361148*u[:,2] + 0.520262285050482*u[:,4]\
                 - 0.051642265516119*u[:,5] + 0.013435342414630*u[:,6]
        
        ux[:,4] = -0.036210680656541*u[:,0] + 0.105400944933782*u[:,1] + 0.015764336127392*u[:,2] - 0.707905442575989*u[:,3]\
            + 0.769199413962647*u[:,5] - 0.164529643265203*u[:,6] + 0.018281071473911*u[:,7]
        
        ux[:,5] = -0.011398193015050*u[:,0] + 0.020437334208704*u[:,1] + 0.011220896474665*u[:,2] + 0.063183694641876*u[:,3]\
            - 0.691649024426814*u[:,4] + 0.739709139060752*u[:,6] - 0.147941827812150*u[:,7] + 0.016437980868017*u[:,8]
        

        ux[:,nx-1] = 1.582533518939116*u[:,nx-1] - 2.033378678700676*u[:,nx-2] + 0.141512858744873*u[:,nx-3] + 0.450398306578272*u[:,nx-4]\
            - 0.104488069284042*u[:,nx-5] - 0.036577936277544*u[:,nx-6]
        
        ux[:,nx-2] = 0.462059195631158*u[:,nx-1] - 0.287258622978251*u[:,nx-3] - 0.258816087376832*u[:,nx-4] + 0.069112065532624*u[:,nx-5]\
            +0.014903449191300*u[:,nx-6]
        
        ux[:,nx-3] = -0.071247104721830*u[:,nx-1] + 0.636451095137907*u[:,nx-2] - 0.606235523609147*u[:,nx-4] + 0.022902190275815*u[:,nx-5]\
                 + 0.018129342917256*u[:,nx-6]
        
        ux[:,nx-4] = -0.114713313798970*u[:,nx-1] + 0.290087484386815*u[:,nx-2] + 0.306681191361148*u[:,nx-3] - 0.520262285050482*u[:,nx-5]\
                 + 0.051642265516119*u[:,nx-6] - 0.013435342414630*u[:,nx-7]
        
        ux[:,nx-5] = 0.036210680656541*u[:,nx-1] - 0.105400944933782*u[:,nx-2] - 0.015764336127392*u[:,nx-3] + 0.707905442575989*u[:,nx-4]\
            - 0.769199413962647*u[:,nx-6] + 0.164529643265203*u[:,nx-7] - 0.018281071473911*u[:,nx-8]
        
        ux[:,nx-6] = 0.011398193015050*u[:,nx-1] - 0.020437334208704*u[:,nx-2] - 0.011220896474665*u[:,nx-3] - 0.063183694641876*u[:,nx-4]\
            + 0.691649024426814*u[:,nx-5] - 0.739709139060752*u[:,nx-7] + 0.147941827812150*u[:,nx-8] - 0.016437980868017*u[:,nx-9]
       
        
        
        for i in xrange(6, nx-6):
            ux[:,i] = -0.016666666666667*u[:,i-3] + 0.15*u[:,i-2] - 0.75*u[:,i-1] + 0.75*u[:,i+1] - 0.15*u[:,i+2] + 0.016666666666667*u[:,i+3]
    

        ux = (1/h)*ux

    return ux
