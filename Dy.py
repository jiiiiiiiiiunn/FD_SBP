from __future__ import division
import numpy as np

def Dy(u, ny, nx, h, order):
    uy = np.zeros(np.shape(u))

    if order==2:
        # calculate partial derivatives on the boundaries:[0, m] with one-sided difference operators
        ux[0, :] = (u[1, :] -  u[0, :])/dx
        ux[ny-1, :] = (u[ny-1, :] -  u[ny-2, :])/h
        
        #calculate partial derivatives in the interior:(1:nx-1)
        for j in range(1, m):
            ux[j, :] = (u[j+1, :] -  u[j-1, :])/(2.0*h)

    elif order == 4:
        uy[0,:] = -24/17*u[0,:] + 59/34*u[1,:]  - 4/17*u[2,:] - 3/34*u[3,:]
        uy[1,:] = -1/2*u[0,:] + 1/2*u[2,:] 
        uy[2,:] = 4/43*u[0,:] - 59/86*u[1,:]  + 59/86*u[3,:] - 4/43*u[4,:]
        uy[3,:] = 3/98*u[0,:] - 59/98*u[2,:]  + 32/49*u[4,:] - 4/49*u[5,:]
        uy[ny-1,:] = 24/17*u[ny-1,:] - 59/34*u[ny-2,:]  + 4/17*u[ny-3,:] + 3/34*u[ny-4,:]
        uy[ny-2,:] = 1/2*u[ny-1,:] - 1/2*u[ny-3,:] 
        uy[ny-3,:] = -4/43*u[ny-1,:] + 59/86*u[ny-2,:]- 59/86*u[ny-4,:]+ 4/43*u[ny-5,:]
        uy[ny-4,:] = -3/98*u[ny-1,:] + 59/98*u[ny-3,:]- 32/49*u[ny-5,:]+ 4/49*u[ny-6,:]
        
        for j in xrange(4, ny-4):
            uy[j,:] = 1/12*u[j-2,:] - 2/3*u[j-1, :]  + 2/3*u[j+1, :] - 1/12*u[j+2,:]

        uy = uy/h


    elif order==6:
        uy[0,:] = -1.582533518939116*u[0,:] + 2.033378678700676*u[1,:] - 0.141512858744873*u[2,:] -0.450398306578272*u[3,:]\
                + 0.104488069284042*u[4,:] + 0.036577936277544*u[5,:]
            
        uy[1,:] = -0.462059195631158*u[0,:] + 0.287258622978251*u[2,:] + 0.258816087376832*u[3,:] - 0.069112065532624*u[4,:]\
            -0.014903449191300*u[5,:]
        
        uy[2,:] = 0.071247104721830*u[0,:] - 0.636451095137907*u[1,:] + 0.606235523609147*u[3,:] - 0.022902190275815*u[4,:]\
                 - 0.018129342917256*u[5,:]
        
        uy[3,:] = 0.114713313798970*u[0,:] - 0.290087484386815*u[1,:] - 0.306681191361148*u[2,:] + 0.520262285050482*u[4,:]\
                 - 0.051642265516119*u[5,:] + 0.013435342414630*u[6,:]
        
        uy[4,:] = -0.036210680656541*u[0,:] + 0.105400944933782*u[1,:] + 0.015764336127392*u[2,:] - 0.707905442575989*u[3,:]\
            + 0.769199413962647*u[5,:] - 0.164529643265203*u[6,:] + 0.018281071473911*u[7,:]
        
        uy[5,:] = -0.011398193015050*u[0,:] + 0.020437334208704*u[1,:] + 0.011220896474665*u[2,:] + 0.063183694641876*u[3,:]\
            - 0.691649024426814*u[4,:] + 0.739709139060752*u[6,:] - 0.147941827812150*u[7,:] + 0.016437980868017*u[8,:]
        

        uy[ny-1,:] = 1.582533518939116*u[ny-1,:] - 2.033378678700676*u[ny-2,:] + 0.141512858744873*u[ny-3,:] + 0.450398306578272*u[ny-4,:]\
            - 0.104488069284042*u[ny-5,:] - 0.036577936277544*u[ny-6,:]
        
        uy[ny-2,:] = 0.462059195631158*u[ny-1,:] - 0.287258622978251*u[ny-3,:] - 0.258816087376832*u[ny-4,:] + 0.069112065532624*u[ny-5,:]\
            +0.014903449191300*u[ny-6,:]
        
        uy[ny-3,:] = -0.071247104721830*u[ny-1,:] + 0.636451095137907*u[ny-2,:] - 0.606235523609147*u[ny-4,:] + 0.022902190275815*u[ny-5,:]\
                 + 0.018129342917256*u[ny-6,:]
        
        uy[ny-4,:] = -0.114713313798970*u[ny-1,:] + 0.290087484386815*u[ny-2,:] + 0.306681191361148*u[ny-3,:] - 0.520262285050482*u[ny-5,:]\
                 + 0.051642265516119*u[ny-6,:] - 0.013435342414630*u[ny-7,:]
        
        uy[ny-5,:] = 0.036210680656541*u[ny-1,:] - 0.105400944933782*u[ny-2,:] - 0.015764336127392*u[ny-3,:] + 0.707905442575989*u[ny-4,:]\
            - 0.769199413962647*u[ny-6,:] + 0.164529643265203*u[ny-7,:] - 0.018281071473911*u[ny-8,:]
        
        uy[ny-6,:] = 0.011398193015050*u[ny-1,:] - 0.020437334208704*u[ny-2,:] - 0.011220896474665*u[ny-3,:] - 0.063183694641876*u[ny-4,:]\
            + 0.691649024426814*u[ny-5,:] - 0.739709139060752*u[ny-7,:] + 0.147941827812150*u[ny-8,:] - 0.016437980868017*u[ny-9,:]
       
        
        
        for i in xrange(6, ny-6):
            uy[i,:] = -0.016666666666667*u[i-3,:] + 0.15*u[i-2,:] - 0.75*u[i-1,:] + 0.75*u[i+1,:] - 0.15*u[i+2,:] + 0.016666666666667*u[i+3,:]
    

        uy = (1/h)*uy


    return uy
